<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitchen Alchemy - AI Recipe Finder</title>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #FFF8F0 0%, #FFE8D6 50%, #FFF0E1 100%);
            font-family: 'Crimson Pro', Georgia, serif;
            padding: 20px;
            overflow-x: hidden;
        }

        @media (max-width: 600px) {
            body {
                padding: 10px 5px;
            }
        }

        .header {
            max-width: 900px;
            margin: 0 auto;
            padding-top: 40px;
            padding-bottom: 30px;
            text-align: center;
        }

        @media (max-width: 600px) {
            .header {
                padding-top: 20px;
                padding-bottom: 20px;
            }
        }

        .header.hidden {
            display: none;
        }

        .logo-container {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            animation: fadeSlideDown 0.8s ease-out;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            color: #D35400;
        }

        h1 {
            font-size: clamp(2.5rem, 8vw, 4rem);
            font-weight: 700;
            margin: 0;
            background: linear-gradient(135deg, #D35400 0%, #E67E22 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            color: #8B4513;
            font-weight: 400;
            margin: 0;
            opacity: 0;
            animation: fadeIn 0.8s ease-out 0.3s forwards;
        }

        .ai-badge {
            display: inline-block;
            background: linear-gradient(135deg, #E67E22 0%, #D35400 100%);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 12px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            overflow-x: hidden;
        }

        .input-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 10px 40px rgba(211, 84, 0, 0.15);
            margin-bottom: 32px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(211, 84, 0, 0.1);
            opacity: 0;
            animation: fadeSlideUp 0.6s ease-out 0.4s forwards;
        }

        .input-card h2 {
            font-size: 1.5rem;
            color: #D35400;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        #ingredientInput {
            flex: 1;
            padding: 14px 20px;
            font-size: 1.05rem;
            border: 2px solid #FFD7B5;
            border-radius: 12px;
            outline: none;
            font-family: inherit;
            background: #FFFBF7;
            transition: all 0.3s ease;
        }

        #ingredientInput:focus {
            border-color: #E67E22;
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.1);
        }

        .btn-add {
            padding: 14px 24px;
            background: linear-gradient(135deg, #E67E22 0%, #D35400 100%);
            border: none;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.05rem;
            font-weight: 600;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 12px rgba(211, 84, 0, 0.3);
            font-family: inherit;
        }

        .btn-add:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(211, 84, 0, 0.4);
        }

        .ingredients-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            min-height: 20px;
        }

        .ingredient-tag {
            background: linear-gradient(135deg, #FFF4E6 0%, #FFE8D6 100%);
            padding: 10px 16px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
            color: #8B4513;
            border: 1.5px solid #FFD7B5;
            animation: popIn 0.3s ease-out backwards;
            transition: all 0.2s ease;
            cursor: pointer;
            user-select: none;
        }

        .ingredient-tag:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #FFE8D6 0%, #FFD7B5 100%);
            border-color: #E67E22;
        }

        .ingredient-tag:active {
            transform: scale(0.98);
        }

        .ingredient-tag span {
            font-weight: 500;
        }

        .quick-select-section {
            margin-bottom: 20px;
        }

        .quick-select-section h3 {
            font-size: 1rem;
            color: #A04000;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .quick-select-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .quick-select-btn {
            background: linear-gradient(135deg, #FFFBF7 0%, #FFF4E6 100%);
            border: 1.5px solid #FFD7B5;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.95rem;
            color: #8B4513;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
            font-weight: 500;
        }

        .quick-select-btn:hover {
            background: linear-gradient(135deg, #FFE8D6 0%, #FFD7B5 100%);
            border-color: #E67E22;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(211, 84, 0, 0.15);
        }

        .quick-select-btn:active {
            transform: translateY(0);
        }

        .quick-select-btn.added {
            background: linear-gradient(135deg, #D4EDDA 0%, #C3E6CB 100%);
            border-color: #28A745;
            color: #155724;
        }

        .btn-remove {
            background: none;
            border: none;
            cursor: pointer;
            padding: 2px;
            display: flex;
            align-items: center;
            color: #D35400;
            transition: transform 0.2s ease;
        }

        .btn-remove:hover {
            transform: rotate(90deg);
        }

        .error-message {
            color: #C0392B;
            font-size: 0.95rem;
            margin-bottom: 16px;
            padding: 12px;
            background: #FADBD8;
            border-radius: 8px;
            border: 1px solid #F1948A;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .btn-find-recipes {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #D35400 0%, #A04000 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.15rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(160, 64, 0, 0.4);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: inherit;
        }

        .btn-find-recipes:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(160, 64, 0, 0.5);
        }

        .btn-find-recipes:disabled {
            background: #D5D8DC;
            cursor: not-allowed;
            box-shadow: none;
        }

        .recipes-grid {
            display: grid;
            gap: 24px;
            margin-bottom: 40px;
        }

        .recipe-carousel-container {
            display: none;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .recipe-carousel-container.active {
            display: block;
        }

        @media (max-width: 600px) {
            .recipe-carousel-container {
                padding: 10px 5px;
            }

            .carousel-header {
                margin-bottom: 16px;
                padding: 0 5px;
            }
        }

        .carousel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .btn-start-over {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #E67E22;
            border-radius: 12px;
            color: #D35400;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        @media (max-width: 600px) {
            .btn-start-over {
                padding: 10px 16px;
                font-size: 0.9rem;
                gap: 6px;
            }
            
            .btn-start-over svg {
                width: 16px;
                height: 16px;
            }
        }

        .btn-start-over:hover {
            background: #E67E22;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230, 126, 34, 0.3);
        }

        .recipe-counter {
            font-size: 1.1rem;
            color: #8B4513;
            font-weight: 600;
        }

        @media (max-width: 600px) {
            .recipe-counter {
                font-size: 0.95rem;
            }
        }

        .carousel-wrapper {
            position: relative;
            overflow: hidden;
            border-radius: 24px;
            width: 100%;
            max-width: 100%;
        }

        @media (max-width: 600px) {
            .carousel-wrapper {
                border-radius: 16px;
            }
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
        }

        .carousel-slide {
            min-width: 100%;
            max-width: 100%;
            width: 100%;
            flex-shrink: 0;
            flex-grow: 0;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            box-sizing: border-box;
            padding: 0;
        }

        @media (max-width: 600px) {
            .carousel-slide {
                max-height: calc(100vh - 120px);
            }
        }

        /* Custom scrollbar for carousel slides */
        .carousel-slide::-webkit-scrollbar {
            width: 6px;
        }

        .carousel-slide::-webkit-scrollbar-track {
            background: transparent;
        }

        .carousel-slide::-webkit-scrollbar-thumb {
            background: #E67E22;
            border-radius: 3px;
        }

        .carousel-slide::-webkit-scrollbar-thumb:hover {
            background: #D35400;
        }

        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid #E67E22;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
        }

        @media (max-width: 600px) {
            .carousel-nav {
                width: 40px;
                height: 40px;
            }
            
            .carousel-nav svg {
                width: 18px;
                height: 18px;
            }
        }

        .carousel-nav:hover {
            background: #E67E22;
            color: white;
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 4px 12px rgba(230, 126, 34, 0.4);
        }

        .carousel-nav.prev {
            left: -25px;
        }

        .carousel-nav.next {
            right: -25px;
        }

        @media (max-width: 600px) {
            .carousel-nav.prev {
                left: -10px;
            }
            
            .carousel-nav.next {
                right: -10px;
            }
        }

        .carousel-nav:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .carousel-nav:disabled:hover {
            background: rgba(255, 255, 255, 0.95);
            color: inherit;
            transform: translateY(-50%) scale(1);
        }

        .carousel-indicators {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 24px;
        }

        @media (max-width: 600px) {
            .carousel-indicators {
                margin-top: 16px;
                gap: 8px;
            }
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #FFD7B5;
            border: 2px solid #E67E22;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        @media (max-width: 600px) {
            .indicator-dot {
                width: 10px;
                height: 10px;
            }
        }

        .indicator-dot.active {
            background: #E67E22;
            transform: scale(1.3);
        }

        .indicator-dot:hover {
            background: #E67E22;
        }

        @media (max-width: 600px) {
            .carousel-nav.prev {
                left: -15px;
            }
            
            .carousel-nav.next {
                right: -15px;
            }
        }

        .recipe-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 8px 30px rgba(139, 69, 19, 0.15);
            border: 1px solid rgba(230, 126, 34, 0.15);
            opacity: 0;
            animation: fadeSlideUp 0.6s ease-out forwards;
            width: 100%;
            box-sizing: border-box;
            margin: 0;
        }

        @media (max-width: 600px) {
            .recipe-card {
                padding: 20px;
                border-radius: 16px;
            }
        }

        .recipe-card h3 {
            font-size: 2rem;
            color: #D35400;
            margin-bottom: 16px;
            font-weight: 700;
            line-height: 1.2;
        }

        @media (max-width: 600px) {
            .recipe-card h3 {
                font-size: 1.5rem;
                margin-bottom: 12px;
            }
        }

        .video-button-container {
            margin-bottom: 16px;
        }

        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            margin-bottom: 20px;
            border-radius: 16px;
            overflow: hidden;
            background: #000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        @media (max-width: 600px) {
            .video-container {
                margin-bottom: 16px;
                border-radius: 12px;
            }
        }

        .video-iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .video-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .video-placeholder:hover {
            background: linear-gradient(135deg, #2d2d2d 0%, #3d3d3d 100%);
        }

        .video-placeholder.hidden {
            display: none;
        }

        .play-button {
            width: 80px;
            height: 80px;
            background: rgba(255, 0, 0, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            transition: transform 0.3s ease, background 0.3s ease;
        }

        .video-placeholder:hover .play-button {
            transform: scale(1.1);
            background: rgba(255, 0, 0, 1);
        }

        .play-button svg {
            width: 32px;
            height: 32px;
            margin-left: 6px;
        }

        .video-label {
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
            padding: 0 20px;
        }

        @media (max-width: 600px) {
            .play-button {
                width: 60px;
                height: 60px;
            }

            .play-button svg {
                width: 24px;
                height: 24px;
            }

            .video-label {
                font-size: 0.95rem;
            }
        }

        .btn-watch-video {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #FF0000 0%, #CC0000 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            box-shadow: 0 4px 12px rgba(255, 0, 0, 0.3);
            font-family: inherit;
        }

        .btn-watch-video:hover {
            background: linear-gradient(135deg, #CC0000 0%, #990000 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 0, 0, 0.4);
        }

        .btn-watch-video svg {
            flex-shrink: 0;
        }

        @media (max-width: 600px) {
            .btn-watch-video {
                font-size: 0.9rem;
                padding: 10px 20px;
                gap: 8px;
            }
        }

        .recipe-meta {
            display: flex;
            gap: 24px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        @media (max-width: 600px) {
            .recipe-meta {
                gap: 16px;
                margin-bottom: 20px;
            }
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #8B4513;
            font-size: 1rem;
        }

        @media (max-width: 600px) {
            .meta-item {
                font-size: 0.9rem;
            }
            
            .meta-item svg {
                width: 16px;
                height: 16px;
            }
        }

        .additional-ingredients {
            margin-bottom: 24px;
        }

        @media (max-width: 600px) {
            .additional-ingredients {
                margin-bottom: 20px;
            }
        }

        .additional-ingredients h4 {
            font-size: 1.1rem;
            color: #A04000;
            margin-bottom: 12px;
            font-weight: 600;
        }

        @media (max-width: 600px) {
            .additional-ingredients h4 {
                font-size: 1rem;
                margin-bottom: 10px;
            }
        }

        .additional-items {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .additional-item {
            background: #FFF8F0;
            padding: 6px 14px;
            border-radius: 16px;
            font-size: 0.95rem;
            color: #8B4513;
            border: 1px solid #FFE8D6;
        }

        @media (max-width: 600px) {
            .additional-item {
                font-size: 0.85rem;
                padding: 5px 12px;
            }
        }

        .instructions h4 {
            font-size: 1.1rem;
            color: #A04000;
            margin-bottom: 16px;
            font-weight: 600;
        }

        @media (max-width: 600px) {
            .instructions h4 {
                font-size: 1rem;
                margin-bottom: 12px;
            }
        }

        .instructions ol {
            margin: 0;
            padding-left: 24px;
            color: #5D4037;
        }

        @media (max-width: 600px) {
            .instructions ol {
                padding-left: 20px;
            }
        }

        .instructions li {
            margin-bottom: 12px;
            font-size: 1.05rem;
            line-height: 1.6;
            padding-left: 8px;
        }

        @media (max-width: 600px) {
            .instructions li {
                font-size: 0.95rem;
                margin-bottom: 10px;
                padding-left: 4px;
            }
        }

        @keyframes fadeSlideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes popIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-container">
            <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z"/>
                <line x1="6" y1="17" x2="18" y2="17"/>
            </svg>
            <h1>Kitchen Alchemy</h1>
        </div>
        <p class="subtitle">Transform your ingredients into delicious possibilities</p>
        <div class="ai-badge">‚ú® Powered by AI</div>
    </div>

    <div class="container">
        <div class="input-card">
            <h2>What's in your kitchen?</h2>

            <div class="quick-select-section">
                <h3>Quick Select:</h3>
                <div class="quick-select-grid">
                    <button class="quick-select-btn" onclick="quickAddIngredient('chicken')">üçó Chicken</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('beef')">ü•© Beef</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('pork belly')">ü•ì Pork Belly</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('minced pork')">ü•© Minced Pork</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('fish')">üêü Fish</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('prawn')">ü¶ê Prawn</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('scallop')">ü¶™ Scallop</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('eggs')">ü•ö Eggs</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('tofu')">üßà Tofu</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('rice')">üçö Rice</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('noodle')">üçú Noodle</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('pasta')">üçù Pasta</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('bread')">üçû Bread</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('potatoes')">ü•î Potatoes</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('mushroom')">üçÑ Mushroom</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('spinach')">ü•¨ Spinach</button>
                    <button class="quick-select-btn" onclick="quickAddIngredient('onions')">üßÖ Onions</button>
                </div>
            </div>

            <div class="input-group">
                <input 
                    type="text" 
                    id="ingredientInput" 
                    placeholder="Enter an ingredient..."
                    autocomplete="off"
                >
                <button class="btn-add" onclick="addIngredient()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add
                </button>
            </div>

            <div class="ingredients-container" id="ingredientsContainer"></div>

            <div class="error-message" id="errorMessage"></div>

            <button class="btn-find-recipes" id="findRecipesBtn" onclick="findRecipes()">
                Find Recipes
            </button>
        </div>

        <div class="recipes-grid" id="recipesGrid"></div>

        <!-- Recipe Carousel -->
        <div class="recipe-carousel-container" id="recipeCarousel">
            <div class="carousel-header">
                <button class="btn-start-over" onclick="startOver()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    Start Over
                </button>
                <div class="recipe-counter">
                    <span id="currentRecipe">1</span> / <span id="totalRecipes">3</span>
                </div>
            </div>

            <div class="carousel-wrapper">
                <button class="carousel-nav prev" id="prevBtn" onclick="previousRecipe()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>
                
                <div class="carousel-track" id="carouselTrack"></div>
                
                <button class="carousel-nav next" id="nextBtn" onclick="nextRecipe()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
            </div>

            <div class="carousel-indicators" id="carouselIndicators"></div>
        </div>
    </div>

    <script>
        let ingredients = [];
        let currentRecipeIndex = 0;
        let allRecipes = [];
        let touchStartX = 0;
        let touchEndX = 0;

        // Add ingredient on Enter key
        document.getElementById('ingredientInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addIngredient();
            }
        });

        // Keyboard navigation for carousel
        document.addEventListener('keydown', function(e) {
            const carouselActive = document.getElementById('recipeCarousel').classList.contains('active');
            if (carouselActive) {
                if (e.key === 'ArrowLeft') {
                    previousRecipe();
                } else if (e.key === 'ArrowRight') {
                    nextRecipe();
                }
            }
        });

        // Touch swipe support for mobile - will be added after carousel is shown
        function initTouchSupport() {
            const carouselWrapper = document.querySelector('.carousel-wrapper');
            if (carouselWrapper && !carouselWrapper.dataset.touchEnabled) {
                carouselWrapper.dataset.touchEnabled = 'true';
                
                carouselWrapper.addEventListener('touchstart', e => {
                    touchStartX = e.changedTouches[0].screenX;
                });

                carouselWrapper.addEventListener('touchend', e => {
                    touchEndX = e.changedTouches[0].screenX;
                    handleSwipe();
                });
            }
        }

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swiped left - next recipe
                    nextRecipe();
                } else {
                    // Swiped right - previous recipe
                    previousRecipe();
                }
            }
        }

        function addIngredient() {
            const input = document.getElementById('ingredientInput');
            const trimmed = input.value.trim().toLowerCase();
            
            if (trimmed && !ingredients.includes(trimmed)) {
                ingredients.push(trimmed);
                input.value = '';
                hideError();
                renderIngredients();
                updateFindButton();
            }
        }

        function quickAddIngredient(ingredient) {
            const lowerIngredient = ingredient.toLowerCase();
            
            if (!ingredients.includes(lowerIngredient)) {
                ingredients.push(lowerIngredient);
                hideError();
                renderIngredients();
                updateFindButton();
                updateQuickSelectButtons();
            }
        }

        function updateQuickSelectButtons() {
            const buttons = document.querySelectorAll('.quick-select-btn');
            buttons.forEach(btn => {
                const ingredient = btn.onclick.toString().match(/'([^']+)'/)[1];
                if (ingredients.includes(ingredient)) {
                    btn.classList.add('added');
                } else {
                    btn.classList.remove('added');
                }
            });
        }

        function removeIngredient(ingredient) {
            ingredients = ingredients.filter(i => i !== ingredient);
            renderIngredients();
            updateFindButton();
            updateQuickSelectButtons();
        }

        function renderIngredients() {
            const container = document.getElementById('ingredientsContainer');
            container.innerHTML = '';
            
            ingredients.forEach((ingredient, index) => {
                const tag = document.createElement('div');
                tag.className = 'ingredient-tag';
                tag.style.animationDelay = `${index * 0.05}s`;
                tag.onclick = () => removeIngredient(ingredient);
                tag.title = 'Click to remove';
                tag.innerHTML = `
                    <span>${ingredient}</span>
                    <button class="btn-remove" onclick="event.stopPropagation(); removeIngredient('${ingredient.replace(/'/g, "\\'")}')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                `;
                container.appendChild(tag);
            });
            updateQuickSelectButtons();
        }

        function updateFindButton() {
            const btn = document.getElementById('findRecipesBtn');
            btn.disabled = ingredients.length < 2;
        }

        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = message;
            errorEl.classList.add('show');
        }

        function hideError() {
            const errorEl = document.getElementById('errorMessage');
            errorEl.classList.remove('show');
        }

        async function findRecipes() {
            if (ingredients.length < 2) {
                showError('Please add at least 2 ingredients to get recipe ideas');
                return;
            }

            const btn = document.getElementById('findRecipesBtn');
            const originalText = btn.textContent;
            btn.textContent = 'üß™ AI is cooking up ideas...';
            btn.disabled = true;
            hideError();

            try {
                // Call our Netlify serverless function
                const response = await fetch('/.netlify/functions/generate-recipes', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ ingredients }),
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `Request failed with status ${response.status}`);
                }

                const data = await response.json();
                
                if (!data.recipes || !Array.isArray(data.recipes) || data.recipes.length === 0) {
                    throw new Error('No recipes received from AI');
                }
                
                renderRecipes(data.recipes);
            } catch (err) {
                console.error('Error generating recipes:', err);
                showError(`Failed to generate recipes: ${err.message}. Please try again.`);
            } finally {
                btn.textContent = originalText;
                btn.disabled = ingredients.length < 2;
            }
        }

        function renderRecipes(recipes) {
            allRecipes = recipes;
            currentRecipeIndex = 0;

            // Hide input card and header, show carousel
            document.querySelector('.input-card').style.display = 'none';
            document.querySelector('.header').classList.add('hidden');
            document.getElementById('recipeCarousel').classList.add('active');

            // Set total recipes counter
            document.getElementById('totalRecipes').textContent = recipes.length;

            // Build carousel
            const track = document.getElementById('carouselTrack');
            track.innerHTML = '';

            recipes.forEach((recipe, index) => {
                const slide = document.createElement('div');
                slide.className = 'carousel-slide';

                let additionalIngredientsHTML = '';
                if (recipe.additionalIngredients && recipe.additionalIngredients.length > 0) {
                    const items = recipe.additionalIngredients
                        .map(item => `<span class="additional-item">${item}</span>`)
                        .join('');
                    additionalIngredientsHTML = `
                        <div class="additional-ingredients">
                            <h4>You'll also need:</h4>
                            <div class="additional-items">${items}</div>
                        </div>
                    `;
                }

                const instructionsHTML = recipe.instructions
                    .map(instruction => `<li>${instruction}</li>`)
                    .join('');

                // Map recipe types to appropriate curated food images
                const recipeName = recipe.name.toLowerCase();
                let imageUrl;
                
                // Detect dish type and assign appropriate image
                if (recipeName.includes('rice') || recipeName.includes('fried rice')) {
                    imageUrl = 'https://images.unsplash.com/photo-1603133872878-684f208fb84b?w=800&h=600&fit=crop'; // Fried rice
                } else if (recipeName.includes('noodle') || recipeName.includes('pasta') || recipeName.includes('spaghetti')) {
                    imageUrl = 'https://images.unsplash.com/photo-1621996346565-e3dbc646d9a9?w=800&h=600&fit=crop'; // Noodles
                } else if (recipeName.includes('chicken') && (recipeName.includes('grill') || recipeName.includes('roast'))) {
                    imageUrl = 'https://images.unsplash.com/photo-1598103442097-8b74394b95c6?w=800&h=600&fit=crop'; // Grilled chicken
                } else if (recipeName.includes('chicken')) {
                    imageUrl = 'https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=800&h=600&fit=crop'; // Chicken dish
                } else if (recipeName.includes('beef') || recipeName.includes('steak')) {
                    imageUrl = 'https://images.unsplash.com/photo-1544025162-d76694265947?w=800&h=600&fit=crop'; // Beef/steak
                } else if (recipeName.includes('fish') || recipeName.includes('salmon')) {
                    imageUrl = 'https://images.unsplash.com/photo-1485921325833-c519f76c4927?w=800&h=600&fit=crop'; // Fish
                } else if (recipeName.includes('prawn') || recipeName.includes('shrimp') || recipeName.includes('seafood')) {
                    imageUrl = 'https://images.unsplash.com/photo-1559737558-2f5a37fc4d6f?w=800&h=600&fit=crop'; // Seafood
                } else if (recipeName.includes('soup') || recipeName.includes('broth')) {
                    imageUrl = 'https://images.unsplash.com/photo-1547592166-23ac45744acd?w=800&h=600&fit=crop'; // Soup
                } else if (recipeName.includes('salad')) {
                    imageUrl = 'https://images.unsplash.com/photo-1546793665-c74683f339c1?w=800&h=600&fit=crop'; // Salad
                } else if (recipeName.includes('egg') || recipeName.includes('omelette') || recipeName.includes('scrambled')) {
                    imageUrl = 'https://images.unsplash.com/photo-1525351484163-7529414344d8?w=800&h=600&fit=crop'; // Eggs
                } else if (recipeName.includes('stir') && recipeName.includes('fry')) {
                    imageUrl = 'https://images.unsplash.com/photo-1512058564366-18510be2db19?w=800&h=600&fit=crop'; // Stir fry
                } else if (recipeName.includes('curry')) {
                    imageUrl = 'https://images.unsplash.com/photo-1588166524941-3bf61a9c41db?w=800&h=600&fit=crop'; // Curry
                } else if (recipeName.includes('pork')) {
                    imageUrl = 'https://images.unsplash.com/photo-1529042410759-befb1204b468?w=800&h=600&fit=crop'; // Pork
                } else if (recipeName.includes('tofu') || recipeName.includes('vegetarian')) {
                    imageUrl = 'https://images.unsplash.com/photo-1546069901-eacef0df6022?w=800&h=600&fit=crop'; // Tofu/vegetarian
                } else {
                    // Default general food image
                    imageUrl = 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800&h=600&fit=crop'; // Beautiful food plate
                }

                // Generate YouTube search URL
                const videoSearch = recipe.videoSearch || recipe.name.toLowerCase().replace(/[^a-z0-9\s]/g, '');
                const youtubeSearchUrl = `https://www.youtube.com/results?search_query=${encodeURIComponent(videoSearch + ' recipe tutorial')}`;
                const youtubeEmbedSearch = encodeURIComponent(videoSearch + ' recipe tutorial');

                slide.innerHTML = `
                    <div class="recipe-card">
                        <h3>${recipe.name}</h3>
                        <div class="video-container" id="video-container-${index}">
                            <div class="video-placeholder" id="video-placeholder-${index}" onclick="loadVideo(${index}, '${youtubeEmbedSearch.replace(/'/g, "\\'")}')">
                                <div class="play-button">
                                    <svg viewBox="0 0 24 24" fill="white">
                                        <path d="M8 5v14l11-7z"/>
                                    </svg>
                                </div>
                                <div class="video-label">Click to Watch Tutorial</div>
                            </div>
                            <iframe 
                                id="video-iframe-${index}"
                                class="video-iframe" 
                                style="display: none;"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                            </iframe>
                        </div>
                        <div class="recipe-meta">
                            <div class="meta-item">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12 6 12 12 16 14"></polyline>
                                </svg>
                                <span><strong>${recipe.time}</strong> mins</span>
                            </div>
                            <div class="meta-item">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                <span><strong>${recipe.servings}</strong> servings</span>
                            </div>
                        </div>
                        ${additionalIngredientsHTML}
                        <div class="instructions">
                            <h4>Instructions:</h4>
                            <ol>${instructionsHTML}</ol>
                        </div>
                    </div>
                `;

                track.appendChild(slide);
            });

            // Build indicators
            const indicators = document.getElementById('carouselIndicators');
            indicators.innerHTML = '';
            recipes.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = 'indicator-dot';
                if (index === 0) dot.classList.add('active');
                dot.onclick = () => goToRecipe(index);
                indicators.appendChild(dot);
            });

            // Initialize touch support for mobile
            initTouchSupport();

            updateCarousel();
        }

        function updateCarousel() {
            const track = document.getElementById('carouselTrack');
            const offset = -currentRecipeIndex * 100;
            track.style.transform = `translateX(${offset}%)`;

            // Update counter
            document.getElementById('currentRecipe').textContent = currentRecipeIndex + 1;

            // Update indicators
            document.querySelectorAll('.indicator-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === currentRecipeIndex);
            });

            // Update navigation buttons
            document.getElementById('prevBtn').disabled = currentRecipeIndex === 0;
            document.getElementById('nextBtn').disabled = currentRecipeIndex === allRecipes.length - 1;
        }

        function nextRecipe() {
            if (currentRecipeIndex < allRecipes.length - 1) {
                currentRecipeIndex++;
                updateCarousel();
            }
        }

        function previousRecipe() {
            if (currentRecipeIndex > 0) {
                currentRecipeIndex--;
                updateCarousel();
            }
        }

        function goToRecipe(index) {
            currentRecipeIndex = index;
            updateCarousel();
        }

        function startOver() {
            // Hide carousel and show input card and header
            document.getElementById('recipeCarousel').classList.remove('active');
            document.querySelector('.input-card').style.display = 'block';
            document.querySelector('.header').classList.remove('hidden');
            
            // Reset state
            currentRecipeIndex = 0;
            allRecipes = [];
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function loadVideo(index, searchTerm) {
            const placeholder = document.getElementById(`video-placeholder-${index}`);
            const iframe = document.getElementById(`video-iframe-${index}`);
            
            // Show loading state
            placeholder.innerHTML = `
                <div class="play-button">
                    <div style="color: white;">Loading...</div>
                </div>
            `;
            
            // Fetch video ID from our backend
            fetch('/.netlify/functions/get-youtube-video', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ searchTerm: decodeURIComponent(searchTerm) })
            })
            .then(res => res.json())
            .then(data => {
                if (data.videoId) {
                    // Hide placeholder
                    placeholder.classList.add('hidden');
                    
                    // Show and load iframe with specific video
                    iframe.style.display = 'block';
                    iframe.src = `https://www.youtube.com/embed/${data.videoId}?autoplay=1&rel=0`;
                } else {
                    // Fallback: open YouTube search in new tab
                    window.open(`https://www.youtube.com/results?search_query=${searchTerm}`, '_blank');
                    placeholder.innerHTML = `
                        <div class="play-button">
                            <svg viewBox="0 0 24 24" fill="white">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                        </div>
                        <div class="video-label">Opened in new tab</div>
                    `;
                }
            })
            .catch(err => {
                console.error('Error loading video:', err);
                // Fallback: open YouTube search
                window.open(`https://www.youtube.com/results?search_query=${searchTerm}`, '_blank');
                placeholder.innerHTML = `
                    <div class="play-button">
                        <svg viewBox="0 0 24 24" fill="white">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                    </div>
                    <div class="video-label">Opened in new tab</div>
                `;
            });
        }

        // Initialize
        updateFindButton();
    </script>
</body>
</html>
